# PRD: 오늘체육뭐할까?

> **초등 체육 전담교사를 위한 수업·학급 관리 PWA**
> 
> 작성일: 2026-02-09
> 버전: 1.0
> 상태: 프로토타입 완성 → 프로덕션 전환

---

## 1. 프로젝트 개요

### 1.1 한 줄 요약
초등학교 체육 전담교사가 **날씨·대기질 확인 → 수업 추천 → 학급 관리 → 수업 도구 활용**까지 하나의 앱에서 해결하는 모바일 퍼스트 PWA.

### 1.2 배경 및 문제 정의
체육 전담교사는 매일 아침 다음을 반복한다:
- 기상청 앱에서 날씨 확인 → 에어코리아에서 미세먼지 확인 → 야외 가능 여부 판단
- 학년별·반별로 다른 진도를 수첩이나 엑셀로 추적
- 수업 중 팀 편성, 점수판, 타이머를 각각 다른 앱에서 실행
- 수업 아이디어를 유튜브에서 따로 검색

이 모든 워크플로우를 **한 화면**으로 통합한다.

### 1.3 대상 사용자
- **1차**: 나 (개발자 본인, 체육 전담교사)
- **2차**: Google OAuth 연동 후 전국 체육 전담교사 배포

### 1.4 핵심 가치
| 우선순위 | 가치 | 설명 |
|---------|------|------|
| 1 | **즉시성** | 교실 앞, 운동장에서 1초 만에 필요한 정보 확인 |
| 2 | **통합성** | 날씨+수업+학급+도구를 한 앱에서 |
| 3 | **교육과정 정합성** | 2022 개정 교육과정 영역 체계 완전 반영 |
| 4 | **오프라인 대응** | PWA 서비스워커로 핵심 기능 오프라인 동작 |

### 1.5 교육과정 기반
**2022 개정 체육과 교육과정** 3개 영역 + 중영역 체계:

```
운동 💪
├── 체력 운동: 체력 요소별 운동 방법
└── 건강 활동: 건강 생활 습관, 안전

스포츠 ⚽
├── 기술형: 기술의 수월성을 겨루는 스포츠
├── 전략형: 전략에 따라 승패가 결정되는 스포츠
└── 생태형: 환경과의 상호작용 스포츠

표현 🎭
├── 스포츠 표현: 스포츠 맥락의 움직임 표현
├── 전통 표현: 전통 문화 기반 신체 표현
└── 현대 표현: 현대적 창작 움직임
```

학년군별 기술 수준:
- 3~4학년군: 기초기술 (FMS - Fundamental Movement Skills)
- 5~6학년군: 복합·응용기술

---

## 2. 사용자 페르소나

### 페르소나: 체육 전담교사 "김쌤"

| 항목 | 내용 |
|------|------|
| 담당 | 3~6학년 체육 전담 (주 22시간) |
| 학급 수 | 10~12개 학급 |
| 기기 | 아이폰 + 교실 내 아이패드 |
| 일과 | 아침에 날씨 확인 → 오전 4교시 연속 수업 → 오후 수업 → 진도 기록 |
| Pain Point | 학급이 많아 어떤 반이 뭘 했는지 헷갈림, 비 올 때 실내 수업 아이디어 부족 |
| 니즈 | 한 손으로 조작 가능, 수업 중 빠른 팀 편성, 영상 자료 바로 재생 |

### 핵심 사용 시나리오

**시나리오 1: 아침 수업 준비 (07:50)**
1. 앱 열기 → 홈 탭에서 날씨·미세먼지 즉시 확인
2. "야외 가능" 확인 → 추천 탭에서 5학년 필터 → 스포츠·전략형 선택
3. "발야구" 추천 → 양수쌤 영상 링크 터치해서 시범 영상 확인
4. "결정" 버튼 → 해당 학급 수업 기록 자동 저장

**시나리오 2: 수업 중 팀 편성 (09:15)**
1. 도구 탭 → 팀 편성기 → 5-3반 선택
2. 4팀 → "성별 균형 편성" 터치
3. 학생 이름으로 팀 결과 화면 표시 (태블릿에서 학생들에게 보여주기)

**시나리오 3: 갑자기 비 올 때 (10:00)**
1. 홈 탭에서 "🌧️ 실내 수업 추천" 자동 표시
2. 추천 탭 → 날씨 기반 자동 필터가 실내 활동만 표시
3. "요가·스트레칭" 추천 → 바로 수업 전환

---

## 3. 기술 스택

### 3.1 프론트엔드
| 기술 | 버전 | 용도 |
|------|------|------|
| React | 18+ | UI 프레임워크 |
| Vite | 5+ | 빌드 도구 |
| React Router | 6+ | SPA 라우팅 |
| Tailwind CSS | 3+ | 스타일링 (현재 inline → 마이그레이션 예정) |
| Workbox | 7+ | PWA 서비스워커 |
| react-hot-toast | - | 토스트 알림 |

### 3.2 백엔드 / BaaS
| 기술 | 용도 |
|------|------|
| Firebase Auth | Google OAuth 로그인 |
| Cloud Firestore | 데이터 저장 (학급, 명단, 수업 기록) |
| Firebase Hosting | 정적 파일 호스팅 |
| Cloud Functions (선택) | API 프록시 (기상청, 에어코리아 키 보호) |

### 3.3 외부 API
| API | 제공처 | 용도 |
|-----|--------|------|
| 기상청 단기예보 | 공공데이터포털 | 하늘상태, 기온, 강수확률 |
| 에어코리아 대기오염정보 | 공공데이터포털 | PM10, PM2.5 등급 |
| 기상청 생활기상지수 (선택) | 공공데이터포털 | 자외선 지수 |
| YouTube Data API v3 | Google Cloud | 양수쌤 채널 영상 검색 |

### 3.4 개발 환경
| 도구 | 용도 |
|------|------|
| Claude Code | AI 페어 프로그래밍 |
| pnpm | 패키지 매니저 |
| ESLint + Prettier | 코드 품질 |
| Vercel (대안) | 프리뷰 배포 |

---

## 4. 정보 구조 (IA)

### 4.1 탭 구조

```
[🏠 홈] [🎲 추천] [📋 학급] [🛠 도구] [🎬 영상]
```

### 4.2 전체 화면 흐름도

```
┌─────────────────────────────────────────────────────────────┐
│  앱 진입                                                     │
│  ├── (미로그인) → 로그인 화면 → Google OAuth                   │
│  └── (로그인됨) → 학급 설정 여부 체크                           │
│       ├── (미설정) → 학급 설정 위저드                           │
│       └── (설정됨) → 홈 탭                                    │
│                                                              │
│  ⚙️ 설정 버튼 (헤더 우측)                                     │
│  └── 학급 설정 위저드 (언제든 재진입 가능)                       │
│       ├── Step 1: 담당 학년 선택 (1~6학년 복수 선택)            │
│       ├── Step 2: 학년별 반 수 설정 (1~15반)                   │
│       └── Step 3: 학급별 학생 수 설정 (기본 25명)               │
└─────────────────────────────────────────────────────────────┘

┌─ 🏠 홈 ─────────────────────────────────────────────────────┐
│  ┌──────────────────────────────────┐                        │
│  │ 🌤 날씨 위젯                      │                        │
│  │ 하늘상태 | 강수확률 | 미세먼지 | UV │                        │
│  │ [야외 가능 / 실내 추천] 판정       │                        │
│  └──────────────────────────────────┘                        │
│  [🎲 오늘의 수업 추천받기] 버튼                                 │
│  ┌───────┬───────┬───────┐                                   │
│  │담당학급│총학생수│ 학년  │  요약 카드                          │
│  └───────┴───────┴───────┘                                   │
│  ┌──────────────────────────────────┐                        │
│  │ 📋 학급 현황 (칩 나열)             │                        │
│  │ 3-1(24) 3-2(25) 4-1(26) ...     │                        │
│  └──────────────────────────────────┘                        │
│  ┌──────────────────────────────────┐                        │
│  │ ⏱ 최근 수업 (최대 5건)            │                        │
│  │ 4-2 발야구 [스포츠] 2/7          │                        │
│  └──────────────────────────────────┘                        │
└─────────────────────────────────────────────────────────────┘

┌─ 🎲 추천 ───────────────────────────────────────────────────┐
│  (비/미세먼지 나쁨 시 자동 경고 배너)                           │
│  ┌──────────────────────────────────┐                        │
│  │ 🎯 조건 선택                       │                        │
│  │ 학년: [3] [4] [5] [6]            │                        │
│  │ 영역: [💪운동] [⚽스포츠] [🎭표현] │                        │
│  │ 세부: (선택 영역의 중영역 필터)     │                        │
│  └──────────────────────────────────┘                        │
│  [🎲 추천받기] 버튼                                           │
│  ┌──────────────────────────────────┐                        │
│  │ 추천 결과 카드                     │                        │
│  │ 영역 태그 | 세부영역 태그          │                        │
│  │ 활동 이름 (큰 텍스트)              │                        │
│  │ 설명                               │                        │
│  │ [시간][난이도][대상학년]             │                        │
│  │ 🎒 준비물                          │                        │
│  │ ▶️ 양수쌤 영상 보기                │                        │
│  │ [✅ 결정] [🔄 다시]               │                        │
│  └──────────────────────────────────┘                        │
└─────────────────────────────────────────────────────────────┘

┌─ 📋 학급 ───────────────────────────────────────────────────┐
│  헤더: [📋 학급 관리] [⚙️ 학급 재설정]                         │
│  ┌──────────────────────────────────┐                        │
│  │ 학급 목록 (학년별 그룹핑)          │                        │
│  │ 3학년 (3개 반)                    │                        │
│  │ ├─ 1반 [명단 24/24] 24명 ...     │                        │
│  │ ├─ 2반 [명단 미입력] 25명 ...     │                        │
│  │ └─ 3반 [명단 20/23] 23명 ...     │                        │
│  │ 4학년 (3개 반)                    │                        │
│  │ └─ ...                            │                        │
│  └──────────────────────────────────┘                        │
│                                                              │
│  (학급 선택 시 아래 패널 확장)                                  │
│  ┌──────────────────────────────────┐                        │
│  │ 🏫 5학년 3반                      │                        │
│  │ [학생수 26명] [명단 26명] [수업 8회]│                        │
│  │                                    │                        │
│  │ 탭: [👤 명단관리][📋 일괄입력][📖 수업이력]                  │
│  │                                    │                        │
│  │ 👤 명단 관리 뷰                    │                        │
│  │ ┌────────────────────────────┐    │                        │
│  │ │ [1] [이름입력___] [남][여] 🗑│    │                        │
│  │ │ [2] [김민준____] [남][  ] 🗑│    │                        │
│  │ │ [3] [이서윤____] [  ][여] 🗑│    │                        │
│  │ │ ...                         │    │                        │
│  │ └────────────────────────────┘    │                        │
│  │ [+ 학생 추가] [🔢 번호 재정렬]     │                        │
│  │ 성별 통계: 남 13명 | 여 12명      │                        │
│  │                                    │                        │
│  │ 📋 일괄 입력 뷰                    │                        │
│  │ ┌────────────────────────────┐    │                        │
│  │ │ 한 줄에 한 명씩 이름 입력    │    │                        │
│  │ │ 김민준                       │    │                        │
│  │ │ 이서윤                       │    │                        │
│  │ │ 박지호                       │    │                        │
│  │ │ ...                         │    │                        │
│  │ └────────────────────────────┘    │                        │
│  │ [기존 명단 불러오기] [✅ 명단 적용]  │                        │
│  │ 💡 나이스에서 복사 붙여넣기 가능     │                        │
│  │                                    │                        │
│  │ 📖 수업 이력 뷰                    │                        │
│  │ 발야구 [스포츠][전략형] 2/7        │                        │
│  │ 피구   [스포츠][전략형] 2/5        │                        │
│  └──────────────────────────────────┘                        │
└─────────────────────────────────────────────────────────────┘

┌─ 🛠 도구 ───────────────────────────────────────────────────┐
│  탭: [👥 팀편성] [🏀 스코어보드] [⏱ 타이머]                    │
│                                                              │
│  👥 팀 편성기                                                 │
│  ┌──────────────────────────────────┐                        │
│  │ 학급 선택: [3-1][3-2][4-1]...    │                        │
│  │ 팀 수: [2][3][4][5][6]           │                        │
│  │ [🔀 랜덤 편성] [⚖️ 성별 균형]    │                        │
│  │                                    │                        │
│  │ 결과:                              │                        │
│  │ ┌─1팀(6명)─┐ ┌─2팀(6명)─┐       │                        │
│  │ │1.김민준 남│ │3.박지호 남│       │                        │
│  │ │4.최하윤 여│ │2.이서윤 여│       │                        │
│  │ └──────────┘ └──────────┘       │                        │
│  │ 💡 명단 입력 시 이름으로 표시      │                        │
│  └──────────────────────────────────┘                        │
│                                                              │
│  🏀 스코어보드                                                │
│  ┌──────────────────────────────────┐                        │
│  │ 🔴 A팀      VS      🔵 B팀      │                        │
│  │   12                   9         │                        │
│  │  [+] [-]             [+] [-]     │                        │
│  │          [🔄 초기화]              │                        │
│  └──────────────────────────────────┘                        │
│                                                              │
│  ⏱ 타이머                                                    │
│  ┌──────────────────────────────────┐                        │
│  │         10:00                     │                        │
│  │ [3분][5분][10분][15분][20분]       │                        │
│  │       [▶ 시작] [↺]              │                        │
│  └──────────────────────────────────┘                        │
└─────────────────────────────────────────────────────────────┘

┌─ 🎬 영상 ───────────────────────────────────────────────────┐
│  ┌──────────────────────────────────┐                        │
│  │ [▶] 양수쌤체육수업                 │                        │
│  │ 두근두근 양수쌤의 꿀잼 놀이체육 교실│                        │
│  │ [🔗 채널 바로가기]                 │                        │
│  └──────────────────────────────────┘                        │
│                                                              │
│  영상 목록 (YouTube Data API 연동)                             │
│  ┌──────────────────────────────────┐                        │
│  │ [🖼] 꼬리잡기 피구 놀이체육  12만회 │                        │
│  │ [🖼] 킥런볼 완벽 가이드     8.5만회│                        │
│  │ [🖼] 줄넘기 릴레이 5가지    6.3만회│                        │
│  └──────────────────────────────────┘                        │
│                                                              │
│  🔍 종목별 바로 검색                                          │
│  [피구][발야구][농구][배드민턴][축구]...                         │
└─────────────────────────────────────────────────────────────┘
```

---

## 5. 핵심 기능 명세

### 5.1 학급 설정 위저드

| 항목 | 상세 |
|------|------|
| 진입점 | 헤더 ⚙️ 버튼, 홈 탭 미설정 안내, 학급 탭 "재설정" 버튼 |
| Step 1 | 1~6학년 중 담당 학년 복수 선택 (그리드 UI) |
| Step 2 | 학년별 반 수 설정 (1~15반, +/- 버튼) |
| Step 3 | 학급별 학생 수 개별 조정 (기본 25명, 1~45명) |
| 완료 | 학급 자동 생성 + 빈 명단(번호만) 초기화 |
| 재설정 | 기존 설정값 프리필, 경고 후 덮어쓰기 |

**비즈니스 로직:**
- 학급 생성 시 각 학급에 학생 수만큼 빈 명단(번호만 할당)이 자동 생성됨
- 설정 미완료 시 헤더 ⚙️ 버튼에 펄스 애니메이션으로 유도
- 학급 설정 변경 시 기존 수업 기록은 유지 여부 확인 필요 (TODO)

### 5.2 학급 명단 관리

| 기능 | 상세 |
|------|------|
| 개별 입력 | 학생별 이름 텍스트 필드, 성별(남/여) 토글, 메모 |
| 일괄 입력 | 텍스트에어리어에 줄바꿈/쉼표 구분으로 이름 붙여넣기 |
| 학생 추가/삭제 | +버튼으로 추가, 🗑 + 확인으로 삭제 |
| 번호 재정렬 | 삭제 후 빈 번호 재배치 |
| 상태 표시 | 학급 목록에 "명단 N/N" 또는 "명단 미입력" 배지 |
| 성별 통계 | 남/여/미지정 카운트 자동 표시 |

**일괄 입력 로직:**
```
입력: "김민준\n이서윤\n박지호"
→ 1번 학생 이름 = 김민준
→ 2번 학생 이름 = 이서윤
→ 3번 학생 이름 = 박지호
→ 이름 수가 학생 수보다 많으면 학생 자동 추가
→ 기존 이름이 있으면 덮어쓰기
```

### 5.3 날씨·대기질 통합 위젯

**API 3종 통합:**

| API | 데이터 | 갱신 주기 |
|-----|--------|----------|
| 기상청 단기예보 | 하늘상태(SKY), 강수형태(PTY), 기온, 강수확률 | 3시간 |
| 에어코리아 | PM10, PM2.5, 등급 | 1시간 |
| 기상청 생활기상지수 | 자외선 지수 | 1일 |

**야외수업 자동 판단 로직:**
```
1순위: 강수형태 ≠ "없음" → ❌ 실내 수업 추천 (사유: "비/눈 예보")
2순위: PM10 > 80㎍/㎥ (나쁨) → ❌ 실내 수업 권장 (사유: "미세먼지 나쁨")
3순위: 기온 < -5℃ 또는 > 33℃ → ❌ 실내 수업 권장 (사유: "기온 부적합")
4순위: PM10 > 50㎍/㎥ (보통 상위) → ⚠️ 야외 가능(마스크 권장)
기본: ✅ 야외 수업 최적
```

**위젯 표시 항목 (4칸 그리드):**
하늘상태 | 강수확률 | 미세먼지(등급) | 자외선지수

**위치 설정:**
- 프로토: 학교 좌표 하드코딩 (대전 서구)
- 프로덕션: 학교 주소 입력 → 좌표 변환 저장

### 5.4 수업 추천 엔진

**필터 체계 (3단 캐스케이드):**
```
학년 → 영역(운동/스포츠/표현) → 중영역(기술형/전략형/...)
```

**추천 로직:**
1. 날씨 자동 필터: 비/미세먼지 나쁨 → `rainOk: true`인 활동만
2. 사용자 선택 필터 적용
3. 필터링된 풀에서 랜덤 1개 추천
4. 풀이 비면 `rainOk: true` 전체에서 추천 (fallback)

**추천 결과 카드 구성:**
- 영역/세부영역 태그 (색상 구분)
- 활동명, 설명
- 메타 정보: 소요시간, 난이도(⭐1~3), 대상학년
- 준비물 목록
- "양수쌤 영상 보기" 링크 (youtubeKeyword 기반)
- 액션: [✅ 결정] → 학급에 수업 기록 / [🔄 다시] → 재추천

### 5.5 수업 기록

| 항목 | 상세 |
|------|------|
| 기록 시점 | 추천 결과에서 "결정" 버튼 클릭 시 (추후: 수동 기록 추가) |
| 저장 항목 | 학급ID, 활동명, 영역, 세부영역, 날짜 |
| 표시 | 학급 탭 > 수업 이력 뷰 (최근 20건) |
| 학급 목록 반영 | 마지막 활동, 마지막 영역, 마지막 수업일 표시 |
| 영역 분포 | 학급별 운동/스포츠/표현 수업 횟수 (향후 차트) |

### 5.6 수업 도구

**5.6.1 팀 편성기**
- 학급 선택 → 해당 반 명단 기반 편성
- 팀 수: 2~6팀
- 편성 모드: 랜덤 / 성별 균형 (남녀 교대 분배)
- 결과: 팀별 학생 목록 (번호 + 이름 + 성별)
- 명단 미입력 시: 번호로만 편성 + "명단 입력하면 이름으로 표시" 안내

**5.6.2 스코어보드**
- A팀(🔴) vs B팀(🔵)
- +/- 버튼으로 점수 조절
- 초기화 버튼
- 향후: 팀 이름 커스텀, 3팀 이상 지원

**5.6.3 타이머**
- 프리셋: 3분, 5분, 10분, 15분, 20분
- 시작/정지 토글
- 60초 미만 시 빨간색 표시
- 향후: 인터벌 타이머 (운동/휴식 반복)

### 5.7 양수쌤 유튜브 연동

| 항목 | 상세 |
|------|------|
| 채널 | 두근두근 양수쌤의 꿀잼 놀이체육 교실 (UCrFNcTAsT8uv2otdMUf_rwg) |
| 채널 URL | https://www.youtube.com/@양수쌤체육수업 |
| 프로토 | 6개 Mock 영상 데이터 + 종목별 채널 내 검색 URL 생성 |
| 프로덕션 | YouTube Data API v3로 실시간 영상 검색 (channelId + keyword) |
| 추천 연동 | 각 활동에 `youtubeKeyword` 필드 → 추천 결과에서 바로 검색 링크 |

---

## 6. 데이터 모델 & Firebase 스키마

### 6.1 Firestore 컬렉션 구조

```
/users/{uid}
  ├── displayName: string
  ├── email: string
  ├── schoolName: string (선택)
  ├── schoolLocation: { lat, lng }
  ├── createdAt: timestamp
  └── updatedAt: timestamp

/users/{uid}/config
  └── classSetup
        ├── grades: [{ grade, count, students[] }]
        └── updatedAt: timestamp

/users/{uid}/classes/{classId}
  ├── grade: string          // "3학년"
  ├── classNum: number       // 1
  ├── studentCount: number   // 25
  ├── lastActivity: string
  ├── lastDomain: string
  ├── lastDate: string
  ├── createdAt: timestamp
  └── updatedAt: timestamp

/users/{uid}/classes/{classId}/roster/{studentId}
  ├── num: number            // 1
  ├── name: string           // "김민준"
  ├── gender: string         // "남" | "여" | ""
  ├── note: string           // 특이사항
  └── updatedAt: timestamp

/users/{uid}/classes/{classId}/records/{recordId}
  ├── activityName: string   // "발야구"
  ├── activityId: number     // ACTIVITIES_DB의 id
  ├── domain: string         // "스포츠"
  ├── subDomain: string      // "전략형"
  ├── date: string           // "2026-03-15"
  ├── note: string           // 수업 메모 (선택)
  └── createdAt: timestamp

/activities (공유 컬렉션, 읽기 전용)
  └── {activityId}
        ├── name, domain, sub, grades[], indoor, outdoor
        ├── equipment[], duration, difficulty, rainOk
        ├── desc, youtubeKeyword
        └── gradeLevel: string  // "기초기술" | "복합·응용기술"
```

### 6.2 Firestore 보안 규칙

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // 사용자 본인 데이터만 읽기/쓰기
    match /users/{uid}/{document=**} {
      allow read, write: if request.auth != null && request.auth.uid == uid;
    }
    // 활동 DB는 인증된 사용자 누구나 읽기 가능
    match /activities/{actId} {
      allow read: if request.auth != null;
      allow write: if false; // 관리자만 (Admin SDK)
    }
  }
}
```

### 6.3 로컬 상태 ↔ Firestore 동기화 전략

```
[앱 상태 (React)] ←→ [Firestore 실시간 리스너]
       ↕
[오프라인 캐시 (Firestore 내장)]
```

- `onSnapshot` 실시간 리스너로 데이터 바인딩
- Firestore의 오프라인 지속성(enablePersistence) 활용
- 충돌 방지: 단일 사용자이므로 last-write-wins 충분
- 추후 멀티유저 시: 낙관적 업데이트 + 서버 타임스탬프

---

## 7. 외부 API 연동 상세

### 7.1 기상청 단기예보 API

```
엔드포인트: http://apis.data.go.kr/1360000/VilageFcstInfoService_2.0/getUltraSrtFcst
파라미터:
  - serviceKey: 인증키
  - numOfRows: 60
  - base_date: YYYYMMDD
  - base_time: HHMM (매시간 30분 발표)
  - nx, ny: 격자 좌표 (위경도 → 격자 변환 필요)

사용 카테고리:
  - SKY: 하늘상태 (1맑음, 3구름많음, 4흐림)
  - PTY: 강수형태 (0없음, 1비, 2비눈, 3눈, 5빗방울, 6빗방울눈날림, 7눈날림)
  - T1H: 기온 (℃)
  - RN1: 1시간 강수량 (mm)
  - REH: 습도 (%)
```

### 7.2 에어코리아 대기오염정보 API

```
엔드포인트: http://apis.data.go.kr/B552584/ArpltnInforInqireSvc/getMsrstnAcctoRltmMesureDnsty
파라미터:
  - serviceKey: 인증키
  - stationName: 측정소명 (예: "대전")
  - dataTerm: "DAILY"
  - returnType: "json"

사용 필드:
  - pm10Value: PM10 농도 (㎍/㎥)
  - pm25Value: PM2.5 농도 (㎍/㎥)
  - pm10Grade: 등급 (1좋음, 2보통, 3나쁨, 4매우나쁨)
```

### 7.3 YouTube Data API v3

```
엔드포인트: https://www.googleapis.com/youtube/v3/search
파라미터:
  - key: API 키
  - channelId: UCrFNcTAsT8uv2otdMUf_rwg
  - q: 검색어 (youtubeKeyword)
  - type: video
  - maxResults: 5
  - order: relevance

응답에서 사용:
  - snippet.title
  - snippet.thumbnails.medium.url
  - id.videoId → embed URL 생성
```

### 7.4 API 키 관리
- 개발: `.env.local`에 저장
- 프로덕션: Firebase Cloud Functions에서 프록시 (키 노출 방지)
- 공공데이터포털 API는 일일 1,000회 제한 → 캐싱 필수 (1시간 단위)

---

## 8. 디자인 시스템

### 8.1 색상 팔레트

**배경 계열 (다크 테마)**
| 토큰 | HEX | 용도 |
|------|-----|------|
| bg | #0C0E14 | 앱 배경 |
| surface | #151822 | 카드 배경 |
| surface2 | #1C2030 | 중첩 카드, 입력 필드 배경 |
| surface3 | #232840 | 깊은 중첩 요소 |
| border | #2A2F45 | 카드 테두리, 구분선 |

**텍스트 계열**
| 토큰 | HEX | 용도 |
|------|-----|------|
| text | #F1F3F8 | 주요 텍스트 |
| textMuted | #8B90A5 | 보조 텍스트, 레이블 |
| textDim | #5A5F75 | 비활성, 힌트 |

**액센트 계열**
| 토큰 | HEX | 용도 |
|------|-----|------|
| accent | #4ADE80 | 주 액센트 (CTA, 긍정) |
| blue | #60A5FA | 정보, 링크, 스포츠 영역 |
| orange | #FFA726 | 경고, 주의 |
| red | #F87171 | 위험, 에러, 실내 추천 |
| purple | #C084FC | 보조 강조 |

**영역 전용 색상**
| 영역 | HEX | 이모지 |
|------|-----|--------|
| 운동 | #FF6B6B | 💪 |
| 스포츠 | #60A5FA | ⚽ |
| 표현 | #AB47BC | 🎭 |

**스포츠 중영역 색상**
| 중영역 | HEX |
|--------|-----|
| 기술형 | #42A5F5 |
| 전략형 | #5C6BC0 |
| 생태형 | #26A69A |

### 8.2 타이포그래피
- 기본 폰트: Pretendard (웹폰트 CDN)
- 폴백: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif
- 앱 제목: 21px, 800 weight
- 카드 제목: 14~16px, 700~800 weight
- 본문: 12~13px, 400~600 weight
- 캡션: 9~11px, 600 weight
- letter-spacing: 제목 -0.02em

### 8.3 컴포넌트 규칙
- border-radius: 카드 16~18px, 버튼 10~13px, 칩 6~8px
- 카드 패딩: 14~16px
- 그리드 갭: 6~14px
- 버튼 active: scale(0.97)
- 애니메이션: fadeIn (translateY 8px → 0, 0.2~0.3s ease)
- 탭바: 하단 고정, blur 배경, safe-area-inset 대응

### 8.4 반응형 디자인

**사용 맥락:**
```
아침 출근 → 데스크톱으로 수업 설계 (넓은 화면, 키보드)
수업 직전 → 태블릿으로 수업안 확인 (교실 이동 중)
수업 중   → 모바일로 팀편성·점수·타이머 (운동장, 한 손)
```

#### 브레이크포인트

| 기기 | 너비 | Tailwind | 주요 맥락 |
|------|------|----------|----------|
| 모바일 | ~639px | 기본(sm 미만) | 운동장, 한 손 조작, 수업 중 도구 |
| 태블릿 | 640~1023px | sm~md | 교실 아이패드, 수업안 확인 |
| 데스크톱 | 1024px~ | lg~ | 출근 후 수업 설계, 명단 관리 |

#### 레이아웃 전환

**🏠 오늘 탭 (커맨드 센터)**

```
[모바일] 단일 컬럼, 세로 스택
┌──────────────┐
│ 날씨 인라인   │
│ 오늘 시간표   │
│ [수업 설계]   │
│ 최근 수업     │
└──────────────┘

[태블릿] 단일 컬럼, 여유 패딩 (max-w-2xl 센터)
┌────────────────────┐
│ 날씨 인라인          │
│ 오늘 시간표 (넓게)   │
│ [수업 설계]          │
│ 최근 수업            │
└────────────────────┘

[데스크톱] 2컬럼 사이드바
┌──────────────┬─────────────────────┐
│              │                      │
│  오늘 시간표  │  교시 확장 패널       │
│  (좌측 고정)  │  (선택한 교시 상세)    │
│              │  수업안 요약          │
│  날씨        │  [수업 설계하기]       │
│  최근 수업   │  학급 명단 미리보기    │
│              │                      │
└──────────────┴─────────────────────┘
※ 교시 클릭 → 우측 패널에 상세 표시 (모바일에선 인라인 확장)
```

**✏️ 수업 설계 탭**

```
[모바일] 단일 컬럼, 단계별 카드 세로 스택
┌──────────────┐
│ 키워드 입력   │
│ 도입 카드    │
│ 활동1 카드   │
│ 활동2 카드   │
│ 정리 카드    │
│ [저장][복사]  │
└──────────────┘

[태블릿] 단일 컬럼, 카드 넓게 (max-w-3xl 센터)
(모바일과 유사, 여유 있는 패딩)

[데스크톱] 2컬럼
┌──────────────┬─────────────────────┐
│              │                      │
│  키워드 입력  │  수업안 미리보기      │
│  빠른 선택   │  (카드 세로 스택)     │
│              │                      │
│  ─────────  │  도입: 꼬리잡기       │
│  활동 DB     │  활동1: 콘 차기       │
│  검색/필터   │  활동2: 짝 패스       │
│  (좌측 패널) │  정리: 스트레칭       │
│              │                      │
│              │  [저장] [다른반 복사]  │
└──────────────┴─────────────────────┘
※ 좌측에서 활동 검색 → 우측 수업안에 드래그 또는 클릭으로 배치
※ 데스크톱에서 수업 설계가 가장 효율적인 경험
```

**📋 학급 탭**

```
[모바일] 학급 목록 → 터치 → 확장
[태블릿] 학급 목록 → 터치 → 하단 확장 (넓게)
[데스크톱] 2컬럼: 좌측 학급 목록 | 우측 명단·이력
┌──────────────┬─────────────────────┐
│ 3학년        │  3학년 1반           │
│  ├ 1반 ◄──  │  [명단] [일괄] [이력] │
│  ├ 2반       │                      │
│  └ 3반       │  1. 김민준 [남]      │
│ 4학년        │  2. 이서윤 [여]      │
│  ├ 1반       │  3. 박지호 [남]      │
│  ...         │  ...                 │
└──────────────┴─────────────────────┘
```

**🛠 도구 탭**

```
[모바일] 풀스크린 (운동장 사용, 큰 글씨)
  - 스코어보드: 점수 초대형 (60px+)
  - 타이머: 숫자 초대형, 프리셋 버튼 크게
  - 팀편성: 팀별 리스트 세로

[태블릿] 여유 레이아웃, 학생에게 보여주기 최적
  - 스코어보드: 풀스크린 모드 지원
  - 팀편성: 팀별 카드 2열 그리드

[데스크톱] 풀스크린 모드 지원 (프로젝터 연결 대응)
  - 스코어보드: 초대형 폰트, 전체화면 버튼
  - 팀편성: 팀별 카드 3~4열 그리드
```

**⚙️ 설정**

```
[모바일] 풀스크린, 세로 섹션 나열
[태블릿] max-w-xl 센터, 여유 패딩
[데스크톱] max-w-2xl 센터, 시간표 편집 시 그리드 뷰 가능
  - 시간표: 요일별 세로 리스트(모바일) vs 5×6 그리드(데스크톱)
```

#### 네비게이션 전환

```
[모바일/태블릿] 하단 탭바 (5탭 고정)
┌──────────────────────────────────────────┐
│  [🏠오늘]  [✏️설계]  [📋학급]  [🛠도구]  [🎬영상]  │
└──────────────────────────────────────────┘

[데스크톱 1024px+] 좌측 사이드 네비게이션
┌──────┬───────────────────────────────────┐
│      │                                    │
│ 🏠   │           콘텐츠 영역               │
│ ✏️   │                                    │
│ 📋   │                                    │
│ 🛠   │                                    │
│ 🎬   │                                    │
│      │                                    │
│ ⚙️   │                                    │
│      │                                    │
└──────┴───────────────────────────────────┘
※ 사이드바: 아이콘 + 라벨, 접을 수 있음 (아이콘만)
※ 설정은 사이드바 하단 고정
```

#### 터치/클릭 타겟
| 기기 | 최소 타겟 사이즈 |
|------|----------------|
| 모바일 | 44×44px (Apple HIG) |
| 태블릿 | 44×44px |
| 데스크톱 | 32×32px (마우스 정밀) |

#### 폰트 스케일
| 요소 | 모바일 | 태블릿 | 데스크톱 |
|------|--------|--------|---------|
| 페이지 제목 | 21px | 24px | 28px |
| 카드 제목 | 14px | 16px | 18px |
| 본문 | 13px | 14px | 15px |
| 캡션 | 11px | 12px | 13px |

#### 기기별 콘텐츠 max-width
| 기기 | max-width | 비고 |
|------|-----------|------|
| 모바일 | 100% (패딩 16px) | 풀 너비 |
| 태블릿 | 768px (센터) | 좌우 여백 자동 |
| 데스크톱 (단일컬럼) | 960px (센터) | 영상, 설정 등 |
| 데스크톱 (2컬럼) | 1280px | 홈, 설계, 학급 |

#### Tailwind 구현 가이드
```jsx
// 레이아웃 셸
<div className="min-h-screen bg-[#0C0E14]">
  {/* 데스크톱: 사이드바 */}
  <nav className="hidden lg:flex lg:fixed lg:w-20 lg:h-full ...">
    ...
  </nav>

  {/* 콘텐츠 */}
  <main className="lg:ml-20 pb-20 lg:pb-0">
    {/* 페이지별 max-width */}
    <div className="max-w-screen-sm mx-auto px-4
                    md:max-w-3xl
                    lg:max-w-6xl">
      ...
    </div>
  </main>

  {/* 모바일/태블릿: 하단 탭바 */}
  <nav className="fixed bottom-0 w-full lg:hidden ...">
    ...
  </nav>
</div>

// 2컬럼 레이아웃 (홈, 설계, 학급)
<div className="lg:grid lg:grid-cols-[360px_1fr] lg:gap-6">
  <aside className="hidden lg:block">
    {/* 좌측 패널 */}
  </aside>
  <section>
    {/* 우측 메인 콘텐츠 */}
  </section>
</div>

// 모바일에서는 좌측 패널이 숨겨지고 단일 컬럼
```

---

## 9. 활동 데이터베이스

### 9.1 활동 스키마

```typescript
interface Activity {
  id: number;
  name: string;           // "발야구(킥런볼)"
  domain: "운동" | "스포츠" | "표현";
  sub: string;            // "전략형"
  grades: string[];       // ["3학년","4학년","5학년","6학년"]
  indoor: boolean;
  outdoor: boolean;
  equipment: string[];    // ["발야구공","콘"]
  duration: number;       // 분 단위
  difficulty: 1 | 2 | 3;  // 1쉬움 ~ 3어려움
  rainOk: boolean;        // 비/실내에서 가능 여부
  desc: string;
  youtubeKeyword: string; // 양수쌤 채널 검색 키워드
}
```

### 9.2 초기 활동 목록 (20개)

**운동 영역 (5개)**
| # | 활동 | 중영역 | 학년 | 실내 | 시간 | 난이도 |
|---|------|--------|------|------|------|--------|
| 1 | 줄넘기 | 체력 운동 | 3-6 | ✅ | 20분 | ⭐ |
| 2 | 달리기 | 체력 운동 | 3-6 | ❌ | 30분 | ⭐ |
| 3 | 체력 서킷 | 체력 운동 | 5-6 | ✅ | 40분 | ⭐⭐ |
| 4 | 요가·스트레칭 | 건강 활동 | 3-6 | ✅ | 30분 | ⭐ |
| 5 | 안전교육(CPR) | 건강 활동 | 5-6 | ✅ | 40분 | ⭐⭐ |

**스포츠 영역 (12개)**
| # | 활동 | 중영역 | 학년 | 실내 | 시간 | 난이도 |
|---|------|--------|------|------|------|--------|
| 6 | 농구 드리블 | 기술형 | 3-6 | ✅ | 30분 | ⭐⭐ |
| 7 | 배드민턴 | 기술형 | 4-6 | ✅ | 40분 | ⭐⭐ |
| 8 | 티볼 | 기술형 | 3-6 | ❌ | 40분 | ⭐⭐ |
| 9 | 매트 운동 | 기술형 | 3-5 | ✅ | 40분 | ⭐⭐ |
| 10 | 피구 | 전략형 | 3-6 | ❌ | 40분 | ⭐ |
| 11 | 발야구(킥런볼) | 전략형 | 3-6 | ❌ | 40분 | ⭐⭐ |
| 12 | 농구 게임 | 전략형 | 5-6 | ✅ | 40분 | ⭐⭐⭐ |
| 13 | 축구 | 전략형 | 3-6 | ❌ | 40분 | ⭐⭐ |
| 14 | 넷볼 | 전략형 | 4-6 | ✅ | 40분 | ⭐⭐ |
| 15 | 플라잉디스크 | 전략형 | 4-6 | ❌ | 40분 | ⭐⭐ |
| 16 | 오리엔티어링 | 생태형 | 5-6 | ❌ | 40분 | ⭐⭐ |

**표현 영역 (3개)**
| # | 활동 | 중영역 | 학년 | 실내 | 시간 | 난이도 |
|---|------|--------|------|------|------|--------|
| 17 | 창작 댄스 | 현대 표현 | 3-6 | ✅ | 40분 | ⭐⭐ |
| 18 | 줄넘기 댄스 | 스포츠 표현 | 3-6 | ✅ | 40분 | ⭐⭐ |
| 19 | 탈춤·민속놀이 | 전통 표현 | 3-6 | ✅ | 40분 | ⭐⭐ |

### 9.3 활동 DB 확장 계획
- Phase 2: 인라인스케이트(생태형), 수영(건강활동) 등 추가
- Phase 3: 교사 커뮤니티 활동 공유 (Firestore 공유 컬렉션)
- Phase 4: 활동별 상세 지도안 (준비-전개-정리), 평가 루브릭

---

## 10. PWA 설정

### 10.1 manifest.json
```json
{
  "name": "오늘체육뭐할까?",
  "short_name": "체육뭐할까",
  "description": "초등 체육 전담교사를 위한 수업·학급 관리 앱",
  "start_url": "/",
  "display": "standalone",
  "background_color": "#0C0E14",
  "theme_color": "#4ADE80",
  "orientation": "portrait",
  "icons": [
    { "src": "/icon-192.png", "sizes": "192x192", "type": "image/png" },
    { "src": "/icon-512.png", "sizes": "512x512", "type": "image/png" }
  ]
}
```

### 10.2 서비스워커 캐싱 전략
| 리소스 | 전략 | 이유 |
|--------|------|------|
| HTML/JS/CSS | Cache First + Network Fallback | 앱 셸 즉시 로드 |
| 활동 DB | Stale While Revalidate | 자주 안 바뀜 |
| 날씨 API | Network First (1시간 캐시) | 실시간성 중요 |
| YouTube 데이터 | Network First (6시간 캐시) | 적당한 갱신 |
| 폰트/이미지 | Cache First | 불변 리소스 |

---

## 11. 인증 (Google OAuth)

### 11.1 로그인 플로우
```
앱 진입 → Firebase Auth 상태 체크
├── 미인증 → 로그인 화면 (Google 로그인 버튼)
│              └── signInWithPopup(GoogleAuthProvider)
│                    └── 성공 → Firestore에 사용자 문서 생성/업데이트
│                          └── 학급 설정 여부 체크 → 홈 or 설정 위저드
└── 인증됨 → Firestore에서 데이터 로드 → 홈
```

### 11.2 사용자 데이터 구조
- Firebase Auth에서 uid, displayName, email, photoURL 제공
- Firestore `/users/{uid}`에 앱 고유 데이터 저장
- 로그아웃 시 로컬 캐시 클리어

---

## 12. 개발 로드맵

### Phase 1: 프로젝트 초기화 & 코어 (1주)
- [ ] Vite + React + Tailwind 프로젝트 셋업
- [ ] 프로토타입(app_v3.jsx) → 컴포넌트 분리
- [ ] React Router 탭 라우팅
- [ ] 디자인 시스템 토큰 (tailwind.config.js)
- [ ] 학급 설정 위저드
- [ ] 학급 명단 CRUD
- [ ] 활동 DB (하드코딩 → 별도 JSON)

### Phase 2: Firebase 연동 (1주)
- [ ] Firebase 프로젝트 생성 + 초기화
- [ ] Google OAuth 로그인/로그아웃
- [ ] Firestore 스키마 구현
- [ ] useClassManager → Firestore 실시간 동기화
- [ ] 보안 규칙 설정
- [ ] 오프라인 persistence 활성화

### Phase 3: API 연동 (1주)
- [ ] 공공데이터포털 API 키 발급 (기상청 + 에어코리아)
- [ ] 날씨 위젯 실데이터 연동
- [ ] 위경도 ↔ 격자 좌표 변환 유틸
- [ ] API 응답 캐싱 (1시간)
- [ ] YouTube Data API v3 연동 (선택)

### Phase 4: PWA & 배포 (3일)
- [ ] Workbox 서비스워커 설정
- [ ] manifest.json + 앱 아이콘
- [ ] Firebase Hosting 배포
- [ ] 커스텀 도메인 연결 (선택)

### Phase 5: 고도화 (지속)
- [ ] 수업 기록 수동 추가/수정/삭제
- [ ] 학급별 영역 분포 차트 (recharts)
- [ ] 시간표 관리 (요일별 학급 배정)
- [ ] 연간 수업 계획
- [ ] 활동 DB 확장 + 교사 커뮤니티 공유
- [ ] 스코어보드 고도화 (3팀+, 팀명 커스텀)
- [ ] 인터벌 타이머
- [ ] 랜덤 뽑기 (학생 이름 기반)
- [ ] 학생 출석 체크
- [ ] 다크/라이트 테마 전환

---

## 13. 프로젝트 구조 (목표)

```
pe-teacher-app/
├── public/
│   ├── manifest.json
│   ├── icon-192.png
│   ├── icon-512.png
│   └── sw.js
├── src/
│   ├── main.jsx                # 엔트리 포인트
│   ├── App.jsx                 # 라우터 + 레이아웃
│   ├── components/
│   │   ├── layout/
│   │   │   ├── Header.jsx
│   │   │   └── TabBar.jsx
│   │   ├── weather/
│   │   │   └── WeatherWidget.jsx
│   │   ├── recommend/
│   │   │   ├── FilterPanel.jsx
│   │   │   └── ResultCard.jsx
│   │   ├── classes/
│   │   │   ├── ClassList.jsx
│   │   │   ├── RosterEditor.jsx
│   │   │   ├── BulkImport.jsx
│   │   │   └── HistoryView.jsx
│   │   ├── tools/
│   │   │   ├── TeamMaker.jsx
│   │   │   ├── Scoreboard.jsx
│   │   │   └── Timer.jsx
│   │   └── videos/
│   │       └── VideoList.jsx
│   ├── pages/
│   │   ├── HomePage.jsx
│   │   ├── RecommendPage.jsx
│   │   ├── ClassesPage.jsx
│   │   ├── ToolsPage.jsx
│   │   ├── VideosPage.jsx
│   │   ├── SetupWizard.jsx
│   │   └── LoginPage.jsx
│   ├── hooks/
│   │   ├── useAuth.js          # Firebase Auth
│   │   ├── useClassManager.js  # 학급 CRUD + Firestore 동기화
│   │   ├── useWeather.js       # 날씨 API + 캐싱
│   │   └── useRecommend.js     # 추천 엔진
│   ├── services/
│   │   ├── firebase.js         # Firebase 초기화
│   │   ├── weatherApi.js       # 기상청 + 에어코리아
│   │   └── youtubeApi.js       # YouTube Data API
│   ├── data/
│   │   ├── activities.json     # 활동 DB
│   │   ├── domains.js          # 2022 교육과정 영역 정의
│   │   └── constants.js        # 색상, 설정값
│   ├── utils/
│   │   ├── gridConvert.js      # 위경도 → 기상청 격자 변환
│   │   ├── dateUtils.js
│   │   └── generateId.js
│   └── styles/
│       └── globals.css         # Tailwind base + 커스텀
├── .env.local                  # API 키 (git 미추적)
├── firebase.json               # Firebase 호스팅 설정
├── firestore.rules             # 보안 규칙
├── tailwind.config.js
├── vite.config.js
├── PRD.md                      # 이 문서
├── CLAUDE.md                   # Claude Code 컨텍스트 (선택)
└── package.json
```

---

## 14. 제약사항 및 고려사항

### 기술적 제약
- 공공데이터포털 API: 일일 호출 제한 (일반 1,000회/일)
- YouTube Data API: 일일 쿼터 10,000 유닛 (search = 100유닛/회 → 일 100회)
- Firestore 무료 티어: 일 읽기 50K, 쓰기 20K (개인 사용 충분)
- PWA iOS 제한: 푸시 알림 미지원 (iOS 16.4+부터 지원), 서비스워커 캐시 제한

### 개인정보
- 학생 이름은 교사 본인 계정에만 저장 (Firestore 보안 규칙)
- 학생 이름 외 개인정보(주민번호, 주소 등) 일절 수집하지 않음
- 추후 배포 시 개인정보 처리방침 필요

### 접근성
- 색상 대비: WCAG AA 기준 충족 (다크 테마 특성상 밝은 텍스트)
- 터치 타겟: 최소 44px (모바일 접근성)
- 운동장에서 사용: 높은 명도 대비, 큰 텍스트 옵션 (향후)

---

## 부록 A: 프로토타입 참조

현재 프로토타입 파일: `app_v3.jsx` (React 단일 파일, 1,266줄)

프로토타입에서 **이미 구현된 기능:**
- ✅ 5탭 네비게이션 (홈/추천/학급/도구/영상)
- ✅ 학급 설정 3단계 위저드
- ✅ 학급 명단 CRUD (개별 + 일괄 + 삭제 + 번호 재정렬)
- ✅ 성별 입력/통계
- ✅ 날씨 위젯 (Mock 데이터)
- ✅ 수업 추천 엔진 (3단 필터 + 날씨 자동 필터)
- ✅ 양수쌤 유튜브 연동 (Mock + 검색 URL)
- ✅ 팀 편성기 (랜덤 + 성별 균형, 명단 기반)
- ✅ 스코어보드 (A vs B)
- ✅ 타이머 (프리셋 5종)
- ✅ 수업 기록 저장/표시
- ✅ 다크 테마 디자인 시스템
- ✅ Firestore-ready 데이터 구조 (useClassManager 훅)

프로토타입에서 **Mock/미구현:**
- ⏳ 날씨 API 실데이터 (현재 Mock)
- ⏳ YouTube API 실데이터 (현재 Mock 6개)
- ⏳ Firebase Auth (로그인 없음)
- ⏳ Firestore 연동 (로컬 상태만)
- ⏳ PWA 설정 (서비스워커, manifest)
- ⏳ 수업 기록 수동 추가/수정
- ⏳ 시간표, 연간 계획
- ⏳ 컴포넌트 분리 (단일 파일)
- ⏳ Tailwind 마이그레이션 (현재 inline style)

---

*끝.*
